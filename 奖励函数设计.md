 ### 任务描述：
  对于任意一辆电动汽车e，其需要在时间T内，从起点s1前往终点s2，我们需要设计算法，从而给定其一个调度策略P,汽车e会按照P移动。
   汽车在移动中，可以在某些特定的路径上一边移动一边充电，充电功率固定为G，充电时间即在该路径上的移动时间
   题目给出的问题就是如何优化策略P，使得汽车e在到达终点时剩余的电量最少，且满足时间约束T。

   现在，对于汽车的每一个活动，我们需要设计一个奖励函数，从而让其收敛。
   最后剩余的电量固然很重要，但是对于短期的奖励也是有必要的

   对于电动汽车 _e_,其走完任意路段$a\in p_e$ 后的剩余电量如下式所示
   $$
   E_e ^a= \min \left\{ E_e^{a'} + x_e^a \alpha \frac{|a|}{r_e ^a} - \gamma|a|,E_e^{max} \right\}
   $$
   其中$a'$表示$p_e$中路段a的前一条路段。当路段$a$的起点是$s_e$(路段$a$是路径$p_e$的第一条路段）时，$E_a^e$= $E_e^0$。
   $x_e^a$是一个二维变量，用于表示电动汽车$e$是否在路段a补充电量。$x_e^a=1$表示电动汽车$e$在路段$a$补充电量,否则，$x_e^a=0$。$|a|$表示路段a的长度,$\alpha$表示充电功率。




### 奖励函数设置，对于智能体做出的某个动作，但这可能就是即时奖励了

1、充电奖励：当在某路段充电的能量大于消耗的能量时，给予正向奖励，鼓励在适当的路段选择充电。
$$R_1 = \lambda_1(1) (E_{充} -E_{耗})$$
2、最短路径奖励：鼓励智能体选择最短路径上的路段，但允许在特定条件下偏离最短路径而不受到惩罚。
$$
R_\text{2}=\begin{cases}
\lambda_2(10),&\mathrm{if~}D_\text{1}=D_\text{0}\\
\lambda_2(10)\cdot\frac1{1+(D_\text{1}-D_\text{0})},&\mathrm{if~}D_\text{1}>D_\text{0}\text{and }D_\text{1}-D_\text{0}\leq\epsilon\\
0,&\mathrm{if~}D_\text{1}>D_\text{0}\text{且 }D_\text{1}-D_\text{0}>\epsilon\end{cases}
$$
3、绕路惩罚：不仅判断是否是最短路径，还需要考虑智能体绕路是否有合理的动机（如为了充电或电量优化）。
$$
R_\text{3}=\begin{cases}0,&\text{if }E_\text{剩余}<E_\text{阈值}\\-\lambda_3(5)\times(D_\text{新}-D_\text{最短路径}),&\text{if }D_\text{新}>D_\text{最短路径}\text{且 }D_\text{新}-D_\text{最短路径}>\epsilon\end{cases}
$$
4、超时:如果总行驶时间超过了时间约束T，给予严重的的惩罚，表示任务失败
$$
\mathrm{if~} \sum_{a \in P} t_a > T,R_4 =- \lambda_4(150)
$$
5、能源用尽：如果剩余电量E≤0，给予负向奖励；如果因此无法到达终点，给予更大的负向奖励。
* 仅电量耗尽
$$
R_5  = -\lambda_5(100)
$$
* 电量耗尽且未到达终点
$$
R_6 =-\lambda_6(150)
$$

6、到达终点：当电动车到达终点时，给予固定的正向奖励，表示任务完成。
$$R_6 =\lambda_7（200）$$
7、剩余电量的奖励：根据到达终点时的剩余电量给予奖励，鼓励在满足其他约束的情况下，最大化剩余电量。
$$
R_7=\lambda_8(100)\times\left(\frac{E_\text{剩余}}{E_{\max}}\right)^\beta 
$$
引入$\beta=2$，利用指数函数改变奖励增长曲线。
将剩余电量通过指数函数放大，电量越高，奖励越多。
